
(********************************************************************
	@name Coq declarations for metamodel: <bdd>
	@date 2019/05/28 14:06:12
	@description Automatically generated by Ecore2Coq transformation.
 ********************************************************************)

(* Coq libraries *)
Require Import String.
Require Import List.      (* sequence *)
Require Import Multiset.  (* bag *)
Require Import ListSet.   (* set *)
Require Import Omega.
Require Import Bool.

Require Import core.utils.TopUtils.
Require Import core.Metamodel.
Require Import core.Model.

Require Import Coq.Logic.Eqdep_dec.

	
(* Base types *)
Inductive BDD : Set :=
  BuildBDD :
  (* name *) string ->
  BDD.
  
Inductive Port : Set :=
  BuildPort :
  (* name *) string ->
  Port.
  
Inductive InputPort : Set :=
  BuildInputPort :
  (* Inheritence Attribute *) Port -> 
  InputPort.
  
Inductive OutputPort : Set :=
  BuildOutputPort :
  (* Inheritence Attribute *) Port -> 
  OutputPort.
  
Inductive Tree : Set :=
  BuildTree :
  Tree.
  
Inductive Leaf : Set :=
  BuildLeaf :
  (* Inheritence Attribute *) Tree -> 
  Leaf.
  
Inductive Assignment : Set :=
  BuildAssignment :
  (* value *) bool ->
  Assignment.
  
Inductive Subtree : Set :=
  BuildSubtree :
  (* Inheritence Attribute *) Tree -> 
  Subtree.
  

Inductive BDDPorts : Set :=
   BuildBDDPorts :
   BDD ->
   list Port ->
   BDDPorts.
Inductive BDDTree : Set :=
   BuildBDDTree :
   BDD ->
   Tree ->
   BDDTree.
Inductive BDDTrees : Set :=
   BuildBDDTrees :
   BDD ->
   list Tree ->
   BDDTrees.

Inductive PortOwner : Set :=
   BuildPortOwner :
   Port ->
   BDD ->
   PortOwner.

Inductive InputPortSubtrees : Set :=
   BuildInputPortSubtrees :
   InputPort ->
   list Subtree ->
   InputPortSubtrees.

Inductive OutputPortAssignments : Set :=
   BuildOutputPortAssignments :
   OutputPort ->
   list Assignment ->
   OutputPortAssignments.

Inductive TreeOwnerBDD : Set :=
   BuildTreeOwnerBDD :
   Tree ->
   BDD ->
   TreeOwnerBDD.
Inductive TreeOwnerSubtreeForZero : Set :=
   BuildTreeOwnerSubtreeForZero :
   Tree ->
   list Subtree ->
   TreeOwnerSubtreeForZero.
Inductive TreeOwnerSubtreeForOne : Set :=
   BuildTreeOwnerSubtreeForOne :
   Tree ->
   list Subtree ->
   TreeOwnerSubtreeForOne.

Inductive LeafAssignments : Set :=
   BuildLeafAssignments :
   Leaf ->
   list Assignment ->
   LeafAssignments.

Inductive AssignmentPort : Set :=
   BuildAssignmentPort :
   Assignment ->
   OutputPort ->
   AssignmentPort.
Inductive AssignmentOwner : Set :=
   BuildAssignmentOwner :
   Assignment ->
   Leaf ->
   AssignmentOwner.

Inductive SubtreePort : Set :=
   BuildSubtreePort :
   Subtree ->
   InputPort ->
   SubtreePort.
Inductive SubtreeTreeForZero : Set :=
   BuildSubtreeTreeForZero :
   Subtree ->
   Tree ->
   SubtreeTreeForZero.
Inductive SubtreeTreeForOne : Set :=
   BuildSubtreeTreeForOne :
   Subtree ->
   Tree ->
   SubtreeTreeForOne.



(* Accessors *)
Definition BDD_getName (b : BDD) : string :=
  match b with BuildBDD  name  => name end.
 
Definition Port_getName (p : Port) : string :=
  match p with BuildPort  name  => name end.
 
Definition InputPort_getPort (i : InputPort) : Port :=
  match i with BuildInputPort port  => port end.
 
Definition OutputPort_getPort (o : OutputPort) : Port :=
  match o with BuildOutputPort port  => port end.
 
 
Definition Leaf_getTree (l : Leaf) : Tree :=
  match l with BuildLeaf tree  => tree end.
 
Definition Assignment_getValue (a : Assignment) : bool :=
  match a with BuildAssignment  value  => value end.
 
Definition Subtree_getTree (s : Subtree) : Tree :=
  match s with BuildSubtree tree  => tree end.
 


		
(* Meta-types *)
Inductive bddMetamodel_EClass : Set :=
  | BDDEClass
  | PortEClass
  | InputPortEClass
  | OutputPortEClass
  | TreeEClass
  | LeafEClass
  | AssignmentEClass
  | SubtreeEClass
.

Definition bddMetamodel_getTypeByEClass (bdec_arg : bddMetamodel_EClass) : Set :=
  match bdec_arg with
    | BDDEClass => BDD
    | PortEClass => Port
    | InputPortEClass => InputPort
    | OutputPortEClass => OutputPort
    | TreeEClass => Tree
    | LeafEClass => Leaf
    | AssignmentEClass => Assignment
    | SubtreeEClass => Subtree
  end.	

Definition bddMetamodel_getEAttributeTypesByEClass (bdec_arg : bddMetamodel_EClass) : Set :=
  match bdec_arg with
    | BDDEClass => 
    (string)
    | PortEClass => 
    (string)
    | InputPortEClass => 
    (Port)
    | OutputPortEClass => 
    (Port)
    | TreeEClass => 
    (Empty_set)
    | LeafEClass => 
    (Tree)
    | AssignmentEClass => 
    (bool)
    | SubtreeEClass => 
    (Tree)
  end.

Inductive bddMetamodel_EReference : Set :=
| BDDPortsEReference
| BDDTreeEReference
| BDDTreesEReference
| PortOwnerEReference
| InputPortSubtreesEReference
| OutputPortAssignmentsEReference
| TreeOwnerBDDEReference
| TreeOwnerSubtreeForZeroEReference
| TreeOwnerSubtreeForOneEReference
| LeafAssignmentsEReference
| AssignmentPortEReference
| AssignmentOwnerEReference
| SubtreePortEReference
| SubtreeTreeForZeroEReference
| SubtreeTreeForOneEReference
.

Definition bddMetamodel_getTypeByEReference (bder_arg : bddMetamodel_EReference) : Set :=
  match bder_arg with
| BDDPortsEReference => BDDPorts
| BDDTreeEReference => BDDTree
| BDDTreesEReference => BDDTrees
| PortOwnerEReference => PortOwner
| InputPortSubtreesEReference => InputPortSubtrees
| OutputPortAssignmentsEReference => OutputPortAssignments
| TreeOwnerBDDEReference => TreeOwnerBDD
| TreeOwnerSubtreeForZeroEReference => TreeOwnerSubtreeForZero
| TreeOwnerSubtreeForOneEReference => TreeOwnerSubtreeForOne
| LeafAssignmentsEReference => LeafAssignments
| AssignmentPortEReference => AssignmentPort
| AssignmentOwnerEReference => AssignmentOwner
| SubtreePortEReference => SubtreePort
| SubtreeTreeForZeroEReference => SubtreeTreeForZero
| SubtreeTreeForOneEReference => SubtreeTreeForOne
  end.

Definition bddMetamodel_getERoleTypesByEReference (bder_arg : bddMetamodel_EReference) : Set :=
  match bder_arg with
| BDDPortsEReference => (BDD * list Port)
| BDDTreeEReference => (BDD * Tree)
| BDDTreesEReference => (BDD * list Tree)
| PortOwnerEReference => (Port * BDD)
| InputPortSubtreesEReference => (InputPort * list Subtree)
| OutputPortAssignmentsEReference => (OutputPort * list Assignment)
| TreeOwnerBDDEReference => (Tree * BDD)
| TreeOwnerSubtreeForZeroEReference => (Tree * list Subtree)
| TreeOwnerSubtreeForOneEReference => (Tree * list Subtree)
| LeafAssignmentsEReference => (Leaf * list Assignment)
| AssignmentPortEReference => (Assignment * OutputPort)
| AssignmentOwnerEReference => (Assignment * Leaf)
| SubtreePortEReference => (Subtree * InputPort)
| SubtreeTreeForZeroEReference => (Subtree * Tree)
| SubtreeTreeForOneEReference => (Subtree * Tree)
  end.

(* Generic types *)





Inductive bddMetamodel_EObject : Set :=
 | Build_bddMetamodel_EObject : 
    forall (bdec_arg: bddMetamodel_EClass), (bddMetamodel_getTypeByEClass bdec_arg) -> bddMetamodel_EObject.

Inductive bddMetamodel_ELink : Set :=
 | Build_bddMetamodel_ELink : 
    forall (bder_arg:bddMetamodel_EReference), (bddMetamodel_getTypeByEReference bder_arg) -> bddMetamodel_ELink.

(* Reflective functions *)

Lemma bddMetamodel_eqEClass_dec : 
 forall (bdec_arg1:bddMetamodel_EClass) (bdec_arg2:bddMetamodel_EClass), { bdec_arg1 = bdec_arg2 } + { bdec_arg1 <> bdec_arg2 }.
Proof. repeat decide equality. Defined.

Lemma bddMetamodel_eqEReference_dec : 
 forall (bder_arg1:bddMetamodel_EReference) (bder_arg2:bddMetamodel_EReference), { bder_arg1 = bder_arg2 } + { bder_arg1 <> bder_arg2 }.
Proof. repeat decide equality. Defined.

Definition bddMetamodel_getEClass (bdeo_arg : bddMetamodel_EObject) : bddMetamodel_EClass :=
   match bdeo_arg with
  | (Build_bddMetamodel_EObject bdeo_arg _) => bdeo_arg
   end.

Definition bddMetamodel_getEReference (bdel_arg : bddMetamodel_ELink) : bddMetamodel_EReference :=
   match bdel_arg with
  | (Build_bddMetamodel_ELink bdel_arg _) => bdel_arg
   end.

Definition bddMetamodel_instanceOfEClass (bdec_arg: bddMetamodel_EClass) (bdeo_arg : bddMetamodel_EObject): bool :=
  if bddMetamodel_eqEClass_dec (bddMetamodel_getEClass bdeo_arg) bdec_arg then true else false.

Definition bddMetamodel_instanceOfEReference (bder_arg: bddMetamodel_EReference) (bdel_arg : bddMetamodel_ELink): bool :=
  if bddMetamodel_eqEReference_dec (bddMetamodel_getEReference bdel_arg) bder_arg then true else false.

(** Helper of building EObject for model **)
Definition bddMetamodel_getEObjectFromEAttributeValues (bdec_arg : bddMetamodel_EClass) : (bddMetamodel_getEAttributeTypesByEClass bdec_arg) -> bddMetamodel_EObject :=
  match bdec_arg with
    | BDDEClass => 
    (fun (p: (string)) => (Build_bddMetamodel_EObject BDDEClass (BuildBDD p)))
    | PortEClass => 
    (fun (p: (string)) => (Build_bddMetamodel_EObject PortEClass (BuildPort p)))
    | InputPortEClass => 
    (fun (p: (Port)) => (Build_bddMetamodel_EObject InputPortEClass (BuildInputPort p)))
    | OutputPortEClass => 
    (fun (p: (Port)) => (Build_bddMetamodel_EObject OutputPortEClass (BuildOutputPort p)))
    | TreeEClass => 
    (fun (p: Empty_set) => (Build_bddMetamodel_EObject TreeEClass (BuildTree)))
    | LeafEClass => 
    (fun (p: (Tree)) => (Build_bddMetamodel_EObject LeafEClass (BuildLeaf p)))
    | AssignmentEClass => 
    (fun (p: (bool)) => (Build_bddMetamodel_EObject AssignmentEClass (BuildAssignment p)))
    | SubtreeEClass => 
    (fun (p: (Tree)) => (Build_bddMetamodel_EObject SubtreeEClass (BuildSubtree p)))
  end.

(** Helper of building ELink for model **)
Definition bddMetamodel_getELinkFromERoleValues (bder_arg : bddMetamodel_EReference) : (bddMetamodel_getERoleTypesByEReference bder_arg) -> bddMetamodel_ELink :=
  match bder_arg with
| BDDPortsEReference => (fun (p: (BDD * list Port)) => (Build_bddMetamodel_ELink BDDPortsEReference (BuildBDDPorts (fst p) (snd p))))
| BDDTreeEReference => (fun (p: (BDD * Tree)) => (Build_bddMetamodel_ELink BDDTreeEReference (BuildBDDTree (fst p) (snd p))))
| BDDTreesEReference => (fun (p: (BDD * list Tree)) => (Build_bddMetamodel_ELink BDDTreesEReference (BuildBDDTrees (fst p) (snd p))))
| PortOwnerEReference => (fun (p: (Port * BDD)) => (Build_bddMetamodel_ELink PortOwnerEReference (BuildPortOwner (fst p) (snd p))))
| InputPortSubtreesEReference => (fun (p: (InputPort * list Subtree)) => (Build_bddMetamodel_ELink InputPortSubtreesEReference (BuildInputPortSubtrees (fst p) (snd p))))
| OutputPortAssignmentsEReference => (fun (p: (OutputPort * list Assignment)) => (Build_bddMetamodel_ELink OutputPortAssignmentsEReference (BuildOutputPortAssignments (fst p) (snd p))))
| TreeOwnerBDDEReference => (fun (p: (Tree * BDD)) => (Build_bddMetamodel_ELink TreeOwnerBDDEReference (BuildTreeOwnerBDD (fst p) (snd p))))
| TreeOwnerSubtreeForZeroEReference => (fun (p: (Tree * list Subtree)) => (Build_bddMetamodel_ELink TreeOwnerSubtreeForZeroEReference (BuildTreeOwnerSubtreeForZero (fst p) (snd p))))
| TreeOwnerSubtreeForOneEReference => (fun (p: (Tree * list Subtree)) => (Build_bddMetamodel_ELink TreeOwnerSubtreeForOneEReference (BuildTreeOwnerSubtreeForOne (fst p) (snd p))))
| LeafAssignmentsEReference => (fun (p: (Leaf * list Assignment)) => (Build_bddMetamodel_ELink LeafAssignmentsEReference (BuildLeafAssignments (fst p) (snd p))))
| AssignmentPortEReference => (fun (p: (Assignment * OutputPort)) => (Build_bddMetamodel_ELink AssignmentPortEReference (BuildAssignmentPort (fst p) (snd p))))
| AssignmentOwnerEReference => (fun (p: (Assignment * Leaf)) => (Build_bddMetamodel_ELink AssignmentOwnerEReference (BuildAssignmentOwner (fst p) (snd p))))
| SubtreePortEReference => (fun (p: (Subtree * InputPort)) => (Build_bddMetamodel_ELink SubtreePortEReference (BuildSubtreePort (fst p) (snd p))))
| SubtreeTreeForZeroEReference => (fun (p: (Subtree * Tree)) => (Build_bddMetamodel_ELink SubtreeTreeForZeroEReference (BuildSubtreeTreeForZero (fst p) (snd p))))
| SubtreeTreeForOneEReference => (fun (p: (Subtree * Tree)) => (Build_bddMetamodel_ELink SubtreeTreeForOneEReference (BuildSubtreeTreeForOne (fst p) (snd p))))
  end.

Definition bddMetamodel_toEClass (bdec_arg : bddMetamodel_EClass) (bdeo_arg : bddMetamodel_EObject) : option (bddMetamodel_getTypeByEClass bdec_arg).
Proof.
  destruct bdeo_arg as [arg1 arg2].
  destruct (bddMetamodel_eqEClass_dec arg1 bdec_arg) as [e|] eqn:dec_case.
  - rewrite e in arg2.
    exact (Some arg2).
  - exact None.
Defined.

Definition bddMetamodel_toEReference (bder_arg : bddMetamodel_EReference) (bdel_arg : bddMetamodel_ELink) : option (bddMetamodel_getTypeByEReference bder_arg).
Proof.
  destruct bdel_arg as [arg1 arg2].
  destruct (bddMetamodel_eqEReference_dec arg1 bder_arg) as [e|] eqn:dec_case.
  - rewrite e in arg2.
  	exact (Some arg2).
  - exact None.
Defined.

(* Generic functions *)
Definition bddMetamodel_toEObjectFromBDD (bd_arg :BDD) : bddMetamodel_EObject :=
  (Build_bddMetamodel_EObject BDDEClass bd_arg).
Coercion bddMetamodel_toEObjectFromBDD : BDD >-> bddMetamodel_EObject.

Definition bddMetamodel_toEObjectFromPort (po_arg :Port) : bddMetamodel_EObject :=
  (Build_bddMetamodel_EObject PortEClass po_arg).
Coercion bddMetamodel_toEObjectFromPort : Port >-> bddMetamodel_EObject.

Definition bddMetamodel_toEObjectFromInputPort (in_arg :InputPort) : bddMetamodel_EObject :=
  (Build_bddMetamodel_EObject InputPortEClass in_arg).
Coercion bddMetamodel_toEObjectFromInputPort : InputPort >-> bddMetamodel_EObject.

Definition bddMetamodel_toEObjectFromOutputPort (ou_arg :OutputPort) : bddMetamodel_EObject :=
  (Build_bddMetamodel_EObject OutputPortEClass ou_arg).
Coercion bddMetamodel_toEObjectFromOutputPort : OutputPort >-> bddMetamodel_EObject.

Definition bddMetamodel_toEObjectFromTree (tr_arg :Tree) : bddMetamodel_EObject :=
  (Build_bddMetamodel_EObject TreeEClass tr_arg).
Coercion bddMetamodel_toEObjectFromTree : Tree >-> bddMetamodel_EObject.

Definition bddMetamodel_toEObjectFromLeaf (le_arg :Leaf) : bddMetamodel_EObject :=
  (Build_bddMetamodel_EObject LeafEClass le_arg).
Coercion bddMetamodel_toEObjectFromLeaf : Leaf >-> bddMetamodel_EObject.

Definition bddMetamodel_toEObjectFromAssignment (as_arg :Assignment) : bddMetamodel_EObject :=
  (Build_bddMetamodel_EObject AssignmentEClass as_arg).
Coercion bddMetamodel_toEObjectFromAssignment : Assignment >-> bddMetamodel_EObject.

Definition bddMetamodel_toEObjectFromSubtree (su_arg :Subtree) : bddMetamodel_EObject :=
  (Build_bddMetamodel_EObject SubtreeEClass su_arg).
Coercion bddMetamodel_toEObjectFromSubtree : Subtree >-> bddMetamodel_EObject.




(** Metamodel Type Class Instaniation **)
Definition bddMetamodel_toEObject (bdeo_arg : bddMetamodel_EObject) : bddMetamodel_EObject := bdeo_arg.
Definition bddMetamodel_toELink (bdel_arg : bddMetamodel_ELink) : bddMetamodel_ELink := bdel_arg.
Definition bddModel := Model bddMetamodel_EObject bddMetamodel_ELink.

Definition bddMetamodel_toEObjectOfEClass (bdec_arg: bddMetamodel_EClass) (t: bddMetamodel_getTypeByEClass bdec_arg) : bddMetamodel_EObject :=
  (Build_bddMetamodel_EObject bdec_arg t).

Definition bddMetamodel_toELinkOfEReference (bder_arg: bddMetamodel_EReference) (t: bddMetamodel_getTypeByEReference bder_arg) : bddMetamodel_ELink :=
		  (Build_bddMetamodel_ELink bder_arg t).


(* Accessors on model *)
(* Equality for Types *)
(*? We currently define eq for Eclass on their fist attribute *)
Definition beq_BDD (bd_arg1 : BDD) (bd_arg2 : BDD) : bool :=
( beq_string (BDD_getName bd_arg1) (BDD_getName bd_arg2) )
.

Definition beq_Port (po_arg1 : Port) (po_arg2 : Port) : bool :=
( beq_string (Port_getName po_arg1) (Port_getName po_arg2) )
.

Definition beq_InputPort (in_arg1 : InputPort) (in_arg2 : InputPort) : bool :=
beq_Port (InputPort_getPort in_arg1) (InputPort_getPort in_arg2)
.

Definition beq_OutputPort (ou_arg1 : OutputPort) (ou_arg2 : OutputPort) : bool :=
beq_Port (OutputPort_getPort ou_arg1) (OutputPort_getPort ou_arg2)
.

Definition beq_Tree (tr_arg1 : Tree) (tr_arg2 : Tree) : bool :=
(true)
.

Definition beq_Leaf (le_arg1 : Leaf) (le_arg2 : Leaf) : bool :=
beq_Tree (Leaf_getTree le_arg1) (Leaf_getTree le_arg2)
.

Definition beq_Assignment (as_arg1 : Assignment) (as_arg2 : Assignment) : bool :=
( eqb (Assignment_getValue as_arg1) (Assignment_getValue as_arg2) )
.

Definition beq_Subtree (su_arg1 : Subtree) (su_arg2 : Subtree) : bool :=
beq_Tree (Subtree_getTree su_arg1) (Subtree_getTree su_arg2)
.



Fixpoint bddMetamodel_Tree_downcastLeaf (tr_arg : Tree) (l : list bddMetamodel_EObject) : option Leaf := 
  match l with
	 | Build_bddMetamodel_EObject LeafEClass (BuildLeaf eSuper ) :: l' => 
		if beq_Tree tr_arg eSuper then (Some (BuildLeaf eSuper )) else (bddMetamodel_Tree_downcastLeaf tr_arg l')
	 | _ :: l' => (bddMetamodel_Tree_downcastLeaf tr_arg l')
	 | nil => None
end.

Definition Tree_downcastLeaf (tr_arg : Tree) (m : bddModel) : option Leaf :=
  bddMetamodel_Tree_downcastLeaf tr_arg (@allModelElements _ _ m).

Fixpoint bddMetamodel_Tree_downcastSubtree (tr_arg : Tree) (l : list bddMetamodel_EObject) : option Subtree := 
  match l with
	 | Build_bddMetamodel_EObject SubtreeEClass (BuildSubtree eSuper ) :: l' => 
		if beq_Tree tr_arg eSuper then (Some (BuildSubtree eSuper )) else (bddMetamodel_Tree_downcastSubtree tr_arg l')
	 | _ :: l' => (bddMetamodel_Tree_downcastSubtree tr_arg l')
	 | nil => None
end.

Definition Tree_downcastSubtree (tr_arg : Tree) (m : bddModel) : option Subtree :=
  bddMetamodel_Tree_downcastSubtree tr_arg (@allModelElements _ _ m).


Fixpoint bddMetamodel_Port_downcastInputPort (po_arg : Port) (l : list bddMetamodel_EObject) : option InputPort := 
  match l with
	 | Build_bddMetamodel_EObject InputPortEClass (BuildInputPort eSuper ) :: l' => 
		if beq_Port po_arg eSuper then (Some (BuildInputPort eSuper )) else (bddMetamodel_Port_downcastInputPort po_arg l')
	 | _ :: l' => (bddMetamodel_Port_downcastInputPort po_arg l')
	 | nil => None
end.

Definition Port_downcastInputPort (po_arg : Port) (m : bddModel) : option InputPort :=
  bddMetamodel_Port_downcastInputPort po_arg (@allModelElements _ _ m).

Fixpoint bddMetamodel_Port_downcastOutputPort (po_arg : Port) (l : list bddMetamodel_EObject) : option OutputPort := 
  match l with
	 | Build_bddMetamodel_EObject OutputPortEClass (BuildOutputPort eSuper ) :: l' => 
		if beq_Port po_arg eSuper then (Some (BuildOutputPort eSuper )) else (bddMetamodel_Port_downcastOutputPort po_arg l')
	 | _ :: l' => (bddMetamodel_Port_downcastOutputPort po_arg l')
	 | nil => None
end.

Definition Port_downcastOutputPort (po_arg : Port) (m : bddModel) : option OutputPort :=
  bddMetamodel_Port_downcastOutputPort po_arg (@allModelElements _ _ m).



Fixpoint BDD_getPortsOnLinks (bd_arg : BDD) (l : list bddMetamodel_ELink) : option (list Port) :=
match l with
| (Build_bddMetamodel_ELink BDDPortsEReference (BuildBDDPorts BDD_ctr ports_ctr)) :: l' => 
	  if beq_BDD BDD_ctr bd_arg then Some ports_ctr else BDD_getPortsOnLinks bd_arg l'
| _ :: l' => BDD_getPortsOnLinks bd_arg l'
| nil => None
end.

Definition BDD_getPorts (bd_arg : BDD) (m : bddModel) : option (list Port) :=
  BDD_getPortsOnLinks bd_arg (@allModelLinks _ _ m).
Fixpoint BDD_getTreeOnLinks (bd_arg : BDD) (l : list bddMetamodel_ELink) : option (Tree) :=
match l with
| (Build_bddMetamodel_ELink BDDTreeEReference (BuildBDDTree BDD_ctr tree_ctr)) :: l' => 
	  if beq_BDD BDD_ctr bd_arg then Some tree_ctr else BDD_getTreeOnLinks bd_arg l'
| _ :: l' => BDD_getTreeOnLinks bd_arg l'
| nil => None
end.

Definition BDD_getTree (bd_arg : BDD) (m : bddModel) : option (Tree) :=
  BDD_getTreeOnLinks bd_arg (@allModelLinks _ _ m).
Fixpoint BDD_getTreesOnLinks (bd_arg : BDD) (l : list bddMetamodel_ELink) : option (list Tree) :=
match l with
| (Build_bddMetamodel_ELink BDDTreesEReference (BuildBDDTrees BDD_ctr trees_ctr)) :: l' => 
	  if beq_BDD BDD_ctr bd_arg then Some trees_ctr else BDD_getTreesOnLinks bd_arg l'
| _ :: l' => BDD_getTreesOnLinks bd_arg l'
| nil => None
end.

Definition BDD_getTrees (bd_arg : BDD) (m : bddModel) : option (list Tree) :=
  BDD_getTreesOnLinks bd_arg (@allModelLinks _ _ m).

Fixpoint Port_getOwnerOnLinks (po_arg : Port) (l : list bddMetamodel_ELink) : option (BDD) :=
match l with
| (Build_bddMetamodel_ELink PortOwnerEReference (BuildPortOwner Port_ctr owner_ctr)) :: l' => 
	  if beq_Port Port_ctr po_arg then Some owner_ctr else Port_getOwnerOnLinks po_arg l'
| _ :: l' => Port_getOwnerOnLinks po_arg l'
| nil => None
end.

Definition Port_getOwner (po_arg : Port) (m : bddModel) : option (BDD) :=
  Port_getOwnerOnLinks po_arg (@allModelLinks _ _ m).

Fixpoint InputPort_getSubtreesOnLinks (in_arg : InputPort) (l : list bddMetamodel_ELink) : option (list Subtree) :=
match l with
| (Build_bddMetamodel_ELink InputPortSubtreesEReference (BuildInputPortSubtrees InputPort_ctr subtrees_ctr)) :: l' => 
	  if beq_InputPort InputPort_ctr in_arg then Some subtrees_ctr else InputPort_getSubtreesOnLinks in_arg l'
| _ :: l' => InputPort_getSubtreesOnLinks in_arg l'
| nil => None
end.

Definition InputPort_getSubtrees (in_arg : InputPort) (m : bddModel) : option (list Subtree) :=
  InputPort_getSubtreesOnLinks in_arg (@allModelLinks _ _ m).

Fixpoint OutputPort_getAssignmentsOnLinks (ou_arg : OutputPort) (l : list bddMetamodel_ELink) : option (list Assignment) :=
match l with
| (Build_bddMetamodel_ELink OutputPortAssignmentsEReference (BuildOutputPortAssignments OutputPort_ctr assignments_ctr)) :: l' => 
	  if beq_OutputPort OutputPort_ctr ou_arg then Some assignments_ctr else OutputPort_getAssignmentsOnLinks ou_arg l'
| _ :: l' => OutputPort_getAssignmentsOnLinks ou_arg l'
| nil => None
end.

Definition OutputPort_getAssignments (ou_arg : OutputPort) (m : bddModel) : option (list Assignment) :=
  OutputPort_getAssignmentsOnLinks ou_arg (@allModelLinks _ _ m).

Fixpoint Tree_getOwnerBDDOnLinks (tr_arg : Tree) (l : list bddMetamodel_ELink) : option (BDD) :=
match l with
| (Build_bddMetamodel_ELink TreeOwnerBDDEReference (BuildTreeOwnerBDD Tree_ctr ownerBDD_ctr)) :: l' => 
	  if beq_Tree Tree_ctr tr_arg then Some ownerBDD_ctr else Tree_getOwnerBDDOnLinks tr_arg l'
| _ :: l' => Tree_getOwnerBDDOnLinks tr_arg l'
| nil => None
end.

Definition Tree_getOwnerBDD (tr_arg : Tree) (m : bddModel) : option (BDD) :=
  Tree_getOwnerBDDOnLinks tr_arg (@allModelLinks _ _ m).
Fixpoint Tree_getOwnerSubtreeForZeroOnLinks (tr_arg : Tree) (l : list bddMetamodel_ELink) : option (list Subtree) :=
match l with
| (Build_bddMetamodel_ELink TreeOwnerSubtreeForZeroEReference (BuildTreeOwnerSubtreeForZero Tree_ctr ownerSubtreeForZero_ctr)) :: l' => 
	  if beq_Tree Tree_ctr tr_arg then Some ownerSubtreeForZero_ctr else Tree_getOwnerSubtreeForZeroOnLinks tr_arg l'
| _ :: l' => Tree_getOwnerSubtreeForZeroOnLinks tr_arg l'
| nil => None
end.

Definition Tree_getOwnerSubtreeForZero (tr_arg : Tree) (m : bddModel) : option (list Subtree) :=
  Tree_getOwnerSubtreeForZeroOnLinks tr_arg (@allModelLinks _ _ m).
Fixpoint Tree_getOwnerSubtreeForOneOnLinks (tr_arg : Tree) (l : list bddMetamodel_ELink) : option (list Subtree) :=
match l with
| (Build_bddMetamodel_ELink TreeOwnerSubtreeForOneEReference (BuildTreeOwnerSubtreeForOne Tree_ctr ownerSubtreeForOne_ctr)) :: l' => 
	  if beq_Tree Tree_ctr tr_arg then Some ownerSubtreeForOne_ctr else Tree_getOwnerSubtreeForOneOnLinks tr_arg l'
| _ :: l' => Tree_getOwnerSubtreeForOneOnLinks tr_arg l'
| nil => None
end.

Definition Tree_getOwnerSubtreeForOne (tr_arg : Tree) (m : bddModel) : option (list Subtree) :=
  Tree_getOwnerSubtreeForOneOnLinks tr_arg (@allModelLinks _ _ m).

Fixpoint Leaf_getAssignmentsOnLinks (le_arg : Leaf) (l : list bddMetamodel_ELink) : option (list Assignment) :=
match l with
| (Build_bddMetamodel_ELink LeafAssignmentsEReference (BuildLeafAssignments Leaf_ctr assignments_ctr)) :: l' => 
	  if beq_Leaf Leaf_ctr le_arg then Some assignments_ctr else Leaf_getAssignmentsOnLinks le_arg l'
| _ :: l' => Leaf_getAssignmentsOnLinks le_arg l'
| nil => None
end.

Definition Leaf_getAssignments (le_arg : Leaf) (m : bddModel) : option (list Assignment) :=
  Leaf_getAssignmentsOnLinks le_arg (@allModelLinks _ _ m).

Fixpoint Assignment_getPortOnLinks (as_arg : Assignment) (l : list bddMetamodel_ELink) : option (OutputPort) :=
match l with
| (Build_bddMetamodel_ELink AssignmentPortEReference (BuildAssignmentPort Assignment_ctr port_ctr)) :: l' => 
	  if beq_Assignment Assignment_ctr as_arg then Some port_ctr else Assignment_getPortOnLinks as_arg l'
| _ :: l' => Assignment_getPortOnLinks as_arg l'
| nil => None
end.

Definition Assignment_getPort (as_arg : Assignment) (m : bddModel) : option (OutputPort) :=
  Assignment_getPortOnLinks as_arg (@allModelLinks _ _ m).
Fixpoint Assignment_getOwnerOnLinks (as_arg : Assignment) (l : list bddMetamodel_ELink) : option (Leaf) :=
match l with
| (Build_bddMetamodel_ELink AssignmentOwnerEReference (BuildAssignmentOwner Assignment_ctr owner_ctr)) :: l' => 
	  if beq_Assignment Assignment_ctr as_arg then Some owner_ctr else Assignment_getOwnerOnLinks as_arg l'
| _ :: l' => Assignment_getOwnerOnLinks as_arg l'
| nil => None
end.

Definition Assignment_getOwner (as_arg : Assignment) (m : bddModel) : option (Leaf) :=
  Assignment_getOwnerOnLinks as_arg (@allModelLinks _ _ m).

Fixpoint Subtree_getPortOnLinks (su_arg : Subtree) (l : list bddMetamodel_ELink) : option (InputPort) :=
match l with
| (Build_bddMetamodel_ELink SubtreePortEReference (BuildSubtreePort Subtree_ctr port_ctr)) :: l' => 
	  if beq_Subtree Subtree_ctr su_arg then Some port_ctr else Subtree_getPortOnLinks su_arg l'
| _ :: l' => Subtree_getPortOnLinks su_arg l'
| nil => None
end.

Definition Subtree_getPort (su_arg : Subtree) (m : bddModel) : option (InputPort) :=
  Subtree_getPortOnLinks su_arg (@allModelLinks _ _ m).
Fixpoint Subtree_getTreeForZeroOnLinks (su_arg : Subtree) (l : list bddMetamodel_ELink) : option (Tree) :=
match l with
| (Build_bddMetamodel_ELink SubtreeTreeForZeroEReference (BuildSubtreeTreeForZero Subtree_ctr treeForZero_ctr)) :: l' => 
	  if beq_Subtree Subtree_ctr su_arg then Some treeForZero_ctr else Subtree_getTreeForZeroOnLinks su_arg l'
| _ :: l' => Subtree_getTreeForZeroOnLinks su_arg l'
| nil => None
end.

Definition Subtree_getTreeForZero (su_arg : Subtree) (m : bddModel) : option (Tree) :=
  Subtree_getTreeForZeroOnLinks su_arg (@allModelLinks _ _ m).
Fixpoint Subtree_getTreeForOneOnLinks (su_arg : Subtree) (l : list bddMetamodel_ELink) : option (Tree) :=
match l with
| (Build_bddMetamodel_ELink SubtreeTreeForOneEReference (BuildSubtreeTreeForOne Subtree_ctr treeForOne_ctr)) :: l' => 
	  if beq_Subtree Subtree_ctr su_arg then Some treeForOne_ctr else Subtree_getTreeForOneOnLinks su_arg l'
| _ :: l' => Subtree_getTreeForOneOnLinks su_arg l'
| nil => None
end.

Definition Subtree_getTreeForOne (su_arg : Subtree) (m : bddModel) : option (Tree) :=
  Subtree_getTreeForOneOnLinks su_arg (@allModelLinks _ _ m).


Definition bddMetamodel_defaultInstanceOfEClass (bdec_arg: bddMetamodel_EClass) : (bddMetamodel_getTypeByEClass bdec_arg) :=
  match bdec_arg with
  | BDDEClass => 
  (BuildBDD "")
  | PortEClass => 
  (BuildPort "")
  | InputPortEClass => 
  (BuildInputPort (BuildPort "") )
  | OutputPortEClass => 
  (BuildOutputPort (BuildPort "") )
  | TreeEClass => 
  (BuildTree)
  | LeafEClass => 
  (BuildLeaf (BuildTree))
  | AssignmentEClass => 
  (BuildAssignment true)
  | SubtreeEClass => 
  (BuildSubtree (BuildTree))
  end.

(* Typeclass Instance *)
Instance bddMetamodel : Metamodel bddMetamodel_EObject bddMetamodel_ELink bddMetamodel_EClass bddMetamodel_EReference :=
  {
    denoteModelClass := bddMetamodel_getTypeByEClass;
    denoteModelReference := bddMetamodel_getTypeByEReference;
    toModelClass := bddMetamodel_toEClass;
    toModelReference := bddMetamodel_toEReference;
    toModelElement := bddMetamodel_toEObjectOfEClass;
    toModelLink := bddMetamodel_toELinkOfEReference;
    bottomModelClass := bddMetamodel_defaultInstanceOfEClass;

    (* Theorems *)
    eqModelClass_dec := bddMetamodel_eqEClass_dec;
    eqModelReference_dec := bddMetamodel_eqEReference_dec;

    (* Constructors *)
    BuildModelElement := Build_bddMetamodel_EObject;
    BuildModelLink := Build_bddMetamodel_ELink;
  }.
  
(* Useful lemmas *)
Lemma bdd_invert : 
  forall (bdec_arg: bddMetamodel_EClass) (t1 t2: bddMetamodel_getTypeByEClass bdec_arg), Build_bddMetamodel_EObject bdec_arg t1 = Build_bddMetamodel_EObject bdec_arg t2 -> t1 = t2.
Proof.
  intros.
  inversion H.
  apply inj_pair2_eq_dec in H1.
  exact H1.
  apply bddMetamodel_eqEClass_dec.
Qed.
